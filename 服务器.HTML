<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>京东主服务器状态监控系统</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
        }
        
        body {
            background-color: #0d1117;
            color: #c9d1d9;
            padding: 20px;
            line-height: 1.6;
            position: relative;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        /* 雪花背景 */
        .snowflake {
            position: fixed;
            top: -10px;
            color: #fff;
            font-size: 16px;
            opacity: 0.8;
            pointer-events: none;
            z-index: 9999;
        }
        
        /* 登录界面样式 */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        
        .login-container {
            background-color: #161b22;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            border: 1px solid #30363d;
            width: 90%;
            max-width: 400px;
            position: relative;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 25px;
            border-bottom: 1px solid #30363d;
            padding-bottom: 15px;
        }
        
        .login-title {
            color: #58a6ff;
            font-size: 24px;
            margin-bottom: 10px;
        }
        
        .login-buttons {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .login-btn {
            background-color: #238636;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            flex: 1;
            margin: 0 5px;
            transition: background-color 0.3s;
        }
        
        .login-btn:hover {
            background-color: #2ea043;
        }
        
        .register-btn {
            background-color: #1f6feb;
        }
        
        .register-btn:hover {
            background-color: #2c81ff;
        }
        
        .forgot-btn {
            background-color: #8957e5;
        }
        
        .forgot-btn:hover {
            background-color: #9868f0;
        }
        
        .back-btn {
            background-color: #8b949e;
        }
        
        .back-btn:hover {
            background-color: #a0a9b3;
        }
        
        .login-form {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #8b949e;
        }
        
        .form-group input {
            width: 100%;
            padding: 10px;
            background-color: #0d1117;
            border: 1px solid #30363d;
            border-radius: 5px;
            color: #c9d1d9;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #58a6ff;
        }
        
        .submit-btn {
            width: 100%;
            background-color: #238636;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            margin-bottom: 10px;
        }
        
        .submit-btn:hover {
            background-color: #2ea043;
        }
        
        .message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            display: none;
        }
        
        .success-message {
            background-color: rgba(35, 134, 54, 0.2);
            border: 1px solid #238636;
            color: #3fb950;
        }
        
        .error-message {
            background-color: rgba(218, 54, 51, 0.2);
            border: 1px solid #da3633;
            color: #f85149;
        }
        
        .info-message {
            background-color: rgba(56, 139, 253, 0.2);
            border: 1px solid #388bfd;
            color: #58a6ff;
        }
        
        .server-controls {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
        }
        
        .control-btn {
            background-color: #da3633;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            flex: 1;
            margin: 0 5px;
            transition: background-color 0.3s;
        }
        
        .control-btn:hover {
            background-color: #f85149;
        }
        
        .restore-btn {
            background-color: #238636;
        }
        
        .restore-btn:hover {
            background-color: #2ea043;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #161b22;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            border: 1px solid #30363d;
            display: none; /* 初始隐藏，登录后显示 */
        }
        
        header {
            text-align: center;
            margin-bottom: 25px;
            border-bottom: 1px solid #30363d;
            padding-bottom: 15px;
        }
        
        h1 {
            color: #58a6ff;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #8b949e;
            font-size: 16px;
            letter-spacing: 1px;
        }
        
        .time-display {
            text-align: center;
            margin: 20px 0;
            font-size: 18px;
            color: #8b949e;
        }
        
        .uptime {
            background-color: #0d1117;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #30363d;
        }
        
        .uptime-title {
            color: #58a6ff;
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .uptime-value {
            font-size: 22px;
            font-weight: bold;
            color: #3fb950;
        }
        
        .server-info {
            background-color: #0d1117;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #30363d;
        }
        
        .server-title {
            color: #58a6ff;
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .server-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .metric {
            margin-bottom: 20px;
        }
        
        .metric-title {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            color: #8b949e;
        }
        
        .metric-value {
            color: #58a6ff;
            font-weight: bold;
        }
        
        .progress-bar {
            height: 10px;
            background-color: #21262d;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s ease-in-out;
        }
        
        .cpu-progress {
            background: linear-gradient(90deg, #238636, #3fb950);
        }
        
        .memory-progress {
            background: linear-gradient(90deg, #1f6feb, #58a6ff);
        }
        
        .disk-progress {
            background: linear-gradient(90deg, #db6d28, #ffa657);
        }
        
        .load-progress {
            background: linear-gradient(90deg, #8957e5, #d2a8ff);
        }
        
        .bandwidth-value {
            color: #58a6ff;
            font-weight: bold;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            color: #8b949e;
            font-size: 14px;
        }
        
        /* 新添加的样式 */
        .login-form {
            display: block; /* 默认显示登录表单 */
        }
        
        .login-buttons {
            display: none; /* 隐藏原来的按钮组 */
        }
        
        .form-footer {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            margin-top: 15px;
        }
        
        .form-link {
            color: #58a6ff;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            text-decoration: underline;
            padding: 0;
            margin: 5px 0;
        }
        
        .form-link:hover {
            color: #79c0ff;
        }
        
        /* 新样式：等宽按钮 */
        .form-action-btn {
            width: 100%;
            padding: 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            margin-bottom: 10px;
            border: none;
            color: white;
        }
        
        .register-action-btn {
            background-color: #1f6feb;
        }
        
        .register-action-btn:hover {
            background-color: #2c81ff;
        }
        
        .forgot-action-btn {
            background-color: #8957e5;
        }
        
        .forgot-action-btn:hover {
            background-color: #9868f0;
        }
        
        /* 悬浮窗样式 */
        .floating-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #161b22;
            color: #c9d1d9;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            border: 1px solid #30363d;
            z-index: 10001;
            max-width: 300px;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .floating-toast.show {
            opacity: 1;
            transform: translateX(0);
        }
        
        .toast-success {
            border-left: 4px solid #3fb950;
        }
        
        .toast-info {
            border-left: 4px solid #58a6ff;
        }
        
        .toast-warning {
            border-left: 4px solid #d29922;
        }
        
        .toast-content {
            display: flex;
            align-items: center;
        }
        
        .toast-icon {
            margin-right: 10px;
            font-size: 18px;
        }
        
        .toast-message {
            flex: 1;
        }
        
        /* 模态弹窗样式 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10002;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-container {
            background-color: #161b22;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            border: 1px solid #30363d;
            width: 90%;
            max-width: 400px;
            position: relative;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        .modal-overlay.active .modal-container {
            transform: scale(1);
        }
        
        .modal-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #30363d;
            padding-bottom: 15px;
        }
        
        .modal-back {
            background: none;
            border: none;
            color: #58a6ff;
            font-size: 16px;
            cursor: pointer;
            margin-right: 10px;
        }
        
        .modal-title {
            color: #58a6ff;
            font-size: 20px;
            flex: 1;
            text-align: center;
        }
        
        .modal-body {
            margin-bottom: 20px;
        }
        
        .modal-message {
            text-align: center;
            margin-bottom: 20px;
            color: #c9d1d9;
        }
        
        .modal-footer {
            display: flex;
            justify-content: center;
        }
        
        .modal-btn {
            background-color: #238636;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        .modal-btn:hover {
            background-color: #2ea043;
        }
        
        /* 验证码相关样式 */
        .verification-group {
            display: flex;
            gap: 10px;
        }
        
        .verification-input {
            flex: 1;
        }
        
        .verification-btn {
            background-color: #8957e5;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 15px;
            cursor: pointer;
            transition: background-color 0.3s;
            white-space: nowrap;
        }
        
        .verification-btn:hover {
            background-color: #9868f0;
        }
        
        .verification-btn:disabled {
            background-color: #8b949e;
            cursor: not-allowed;
        }
        
        @media (max-width: 600px) {
            .server-details {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .login-buttons {
                flex-direction: column;
            }
            
            .login-btn {
                margin: 5px 0;
            }
            
            .server-controls {
                flex-direction: column;
            }
            
            .control-btn {
                margin: 5px 0;
            }
            
            .form-footer {
                flex-direction: column;
                align-items: center;
            }
            
            .form-link {
                margin: 5px 0;
            }
            
            .verification-group {
                flex-direction: column;
            }
            
            .verification-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- 雪花背景 -->
    <div id="snowflakes"></div>
    
    <!-- 登录界面 -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-container">
            <div class="login-header">
                <h2 class="login-title">服务器状态监控系统</h2>
                <p class="subtitle">请登录以访问服务器状态</p>
            </div>
            
            <!-- 登录表单 -->
            <div class="login-form" id="loginForm">
                <div class="form-group">
                    <label for="username">账号</label>
                    <input type="text" id="username" placeholder="请输入账号">
                </div>
                <div class="form-group">
                    <label for="password">密码</label>
                    <input type="password" id="password" placeholder="请输入密码">
                </div>
                <button class="submit-btn" id="loginSubmit">点击登录</button>
                <div class="form-footer">
                    <button class="form-action-btn register-action-btn" id="showRegisterForm">用户注册</button>
                    <button class="form-action-btn forgot-action-btn" id="showForgotForm">忘记密码</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 主内容区域 -->
    <div class="container" id="mainContainer">
        <header>
            <h1>京东主服务器</h1>
            <div class="subtitle">稳定运行  高速响应</div>
        </header>
        
        <!-- 服务器控制按钮 -->
        <div class="server-controls">
            <button class="control-btn" id="shutdownServer">一键关闭服务器</button>
            <button class="control-btn restore-btn" id="restoreServer">一键恢复服务器</button>
        </div>
        
        <div class="time-display" id="current-time">
            <!-- 当前时间将通过JavaScript动态显示 -->
        </div>
        
        <div class="uptime">
            <div class="uptime-title">已稳定运行：</div>
            <div class="uptime-value" id="uptime">
                <!-- 稳定运行时间将通过JavaScript动态显示 -->
            </div>
        </div>
        
        <div class="server-info">
            <div class="server-title">主服务器</div>
            <div class="server-details">
                <div>IP: <span id="ip-address">获取中...</span> | 端口: <span id="port">8080</span></div>
                <div>位置: 京东内部主服务器地点</div>
            </div>
        </div>
        
        <div class="metrics">
            <div class="metric">
                <div class="metric-title">
                    <span>CPU占用</span>
                    <span class="metric-value" id="cpu-value">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress cpu-progress" id="cpu-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="metric">
                <div class="metric-title">
                    <span>内存占用</span>
                    <span class="metric-value" id="memory-value">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress memory-progress" id="memory-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="metric">
                <div class="metric-title">
                    <span>磁盘占用</span>
                    <span class="metric-value" id="disk-value">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress disk-progress" id="disk-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="metric">
                <div class="metric-title">
                    <span>负载状态</span>
                    <span class="metric-value" id="load-value">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress load-progress" id="load-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="metric">
                <div class="metric-title">
                    <span>带宽占用</span>
                    <span class="bandwidth-value" id="bandwidth-value">0 Mbps</span>
                </div>
            </div>
        </div>
        
        <footer>
            <p></p>
        </footer>
    </div>
    
    <!-- 悬浮窗提示 -->
    <div class="floating-toast" id="floatingToast">
        <div class="toast-content">
            <div class="toast-icon" id="toastIcon">⚠️</div>
            <div class="toast-message" id="toastMessage">消息内容</div>
        </div>
    </div>
    
    <!-- 注册弹窗 -->
    <div class="modal-overlay" id="registerModal">
        <div class="modal-container">
            <div class="modal-header">
                <button class="modal-back" id="registerBack">← 返回</button>
                <h3 class="modal-title">用户注册</h3>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="registerEmail">邮箱</label>
                    <input type="email" id="registerEmail" placeholder="请输入邮箱">
                </div>
                <div class="form-group">
                    <label for="registerUsername">用户名</label>
                    <input type="text" id="registerUsername" placeholder="请输入用户名">
                </div>
                <div class="form-group">
                    <label for="registerPassword">密码</label>
                    <input type="password" id="registerPassword" placeholder="请输入密码">
                </div>
                <div class="form-group">
                    <label for="confirmPassword">确认密码</label>
                    <input type="password" id="confirmPassword" placeholder="请再次输入密码">
                </div>
                <button class="submit-btn" id="registerSubmit">提交注册</button>
            </div>
        </div>
    </div>
    
    <!-- 忘记密码弹窗 -->
    <div class="modal-overlay" id="forgotModal">
        <div class="modal-container">
            <div class="modal-header">
                <button class="modal-back" id="forgotBack">← 返回</button>
                <h3 class="modal-title">忘记密码</h3>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="forgotEmail">请填写注册账号的邮箱</label>
                    <input type="email" id="forgotEmail" placeholder="请输入邮箱">
                </div>
                <div class="form-group">
                    <div class="verification-group">
                        <input type="text" id="forgotVerificationCode" placeholder="请输入验证码" class="verification-input">
                        <button class="verification-btn" id="sendVerificationCode">发送验证码</button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="newPassword">新密码</label>
                    <input type="password" id="newPassword" placeholder="请输入新密码">
                </div>
                <button class="submit-btn" id="forgotSubmit">提交更改密码</button>
            </div>
        </div>
    </div>
    
    <!-- 登录失败弹窗 -->
    <div class="modal-overlay" id="loginErrorModal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">登录失败</h3>
            </div>
            <div class="modal-body">
                <p class="modal-message">账号或密码错误！</p>
                <div class="modal-footer">
                    <button class="modal-btn" id="loginErrorConfirm">确定</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 请求已收到弹窗 -->
    <div class="modal-overlay" id="requestReceivedModal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">请求已提交</h3>
            </div>
            <div class="modal-body">
                <p class="modal-message">您的请求我们已收到，我们将在24小时之内为您处理</p>
                <div class="modal-footer">
                    <button class="modal-btn" id="requestReceivedConfirm">确定</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 雪花背景效果
        function createSnowflakes() {
            const snowflakesContainer = document.getElementById('snowflakes');
            const snowflakeCount = 50;
            
            for (let i = 0; i < snowflakeCount; i++) {
                const snowflake = document.createElement('div');
                snowflake.classList.add('snowflake');
                snowflake.innerHTML = '❄';
                
                // 随机位置
                const startLeft = Math.random() * 100;
                snowflake.style.left = `${startLeft}vw`;
                
                // 随机大小
                const size = Math.random() * 10 + 10;
                snowflake.style.fontSize = `${size}px`;
                
                // 随机透明度
                const opacity = Math.random() * 0.5 + 0.3;
                snowflake.style.opacity = opacity;
                
                // 随机动画时长
                const duration = Math.random() * 10 + 10;
                snowflake.style.animation = `fall ${duration}s linear infinite`;
                
                // 随机延迟
                const delay = Math.random() * 5;
                snowflake.style.animationDelay = `${delay}s`;
                
                snowflakesContainer.appendChild(snowflake);
            }
            
            // 添加雪花下落动画
            const style = document.createElement('style');
            style.innerHTML = `
                @keyframes fall {
                    to {
                        transform: translateY(100vh) rotate(360deg);
                    }
                }
            `;
            document.head.appendChild(style);
        }
        
        // 显示悬浮窗提示
        function showFloatingToast(message, type = 'info') {
            const toast = document.getElementById('floatingToast');
            const toastMessage = document.getElementById('toastMessage');
            const toastIcon = document.getElementById('toastIcon');
            
            // 设置消息内容
            toastMessage.textContent = message;
            
            // 设置图标和样式
            if (type === 'success') {
                toastIcon.textContent = '✅';
                toast.className = 'floating-toast toast-success';
            } else if (type === 'warning') {
                toastIcon.textContent = '⚠️';
                toast.className = 'floating-toast toast-warning';
            } else if (type === 'info') {
                toastIcon.textContent = '⚠️';
                toast.className = 'floating-toast toast-info';
            }
            
            // 添加显示类
            setTimeout(() => {
                toast.classList.add('show');
            }, 10);
            
            // 3秒后自动隐藏
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // 显示模态弹窗
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.add('active');
        }
        
        // 隐藏模态弹窗
        function hideModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('active');
        }
        
        // 获取用户真实IP地址
        async function getUserIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (error) {
                console.error('获取IP地址失败:', error);
                return '192.168.1.100'; // 失败时返回默认值
            }
        }

        // 根据IP生成端口号（使用IP后四位）
        function generatePortFromIP(ip) {
            // 移除IP中的点号，然后取后四位数字
            const numbers = ip.replace(/\./g, '');
            const lastFour = numbers.slice(-4);
            
            // 确保端口号在合理范围内（1000-9999）
            let port = parseInt(lastFour, 10);
            if (port < 1000) port += 1000;
            if (port > 9999) port = port % 10000;
            
            return port;
        }

        // 更新当前时间
        function updateCurrentTime() {
            const now = new Date();
            // 转换为北京时间 (UTC+8)
            const beijingTime = new Date(now.getTime() + 8 * 60 * 60 * 1000);
            
            const year = beijingTime.getUTCFullYear();
            const month = String(beijingTime.getUTCMonth() + 1).padStart(2, '0');
            const day = String(beijingTime.getUTCDate()).padStart(2, '0');
            const hours = String(beijingTime.getUTCHours()).padStart(2, '0');
            const minutes = String(beijingTime.getUTCMinutes()).padStart(2, '0');
            const seconds = String(beijingTime.getUTCSeconds()).padStart(2, '0');
            
            document.getElementById('current-time').textContent = 
                `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        }

        // 计算稳定运行时间
        function calculateUptime() {
            const now = new Date();
            // 转换为北京时间 (UTC+8)
            const beijingTime = new Date(now.getTime() + 8 * 60 * 60 * 1000);
            
            // 获取当前时间的时、分、秒
            const hours = beijingTime.getUTCHours();
            const minutes = beijingTime.getUTCMinutes();
            const seconds = beijingTime.getUTCSeconds();
            
            // 计算累计天数（小时满24后增加天数）
            const totalHours = 2 * 365 * 24 + 5 * 24 + hours; // 2年5天+当前小时
            const days = Math.floor(totalHours / 24);
            const remainingHours = totalHours % 24;
            
            document.getElementById('uptime').textContent = 
                `${Math.floor(days/365)}年 ${days % 365}天 ${remainingHours}时 ${minutes}分 ${seconds}秒`;
        }

        // 生成随机系统指标（占用率在30-55%之间）
        function generateMetrics() {
            // 检查服务器是否处于关闭状态
            const isShutdown = localStorage.getItem('serverShutdown') === 'true';
            
            if (isShutdown) {
                // 服务器关闭状态，所有指标为0
                document.getElementById('cpu-value').textContent = '0%';
                document.getElementById('cpu-progress').style.width = '0%';
                
                document.getElementById('memory-value').textContent = '0%';
                document.getElementById('memory-progress').style.width = '0%';
                
                document.getElementById('disk-value').textContent = '0%';
                document.getElementById('disk-progress').style.width = '0%';
                
                document.getElementById('load-value').textContent = '0%';
                document.getElementById('load-progress').style.width = '0%';
                
                document.getElementById('bandwidth-value').textContent = '0 Mbps';
                return;
            }
            
            // 生成占用率在30-55%之间
            const cpu = Math.floor(Math.random() * 26) + 30;      // 30-55%
            const memory = Math.floor(Math.random() * 26) + 30;   // 30-55%
            const disk = Math.floor(Math.random() * 26) + 30;     // 30-55%
            const load = Math.floor(Math.random() * 26) + 30;     // 30-55%
            
            // 生成带宽在35-80 Mbps之间，变化较小
            let bandwidth = parseFloat(document.getElementById('bandwidth-value').textContent) || 50;
            
            // 带宽变化较小，每次更新只变化±5 Mbps
            const change = (Math.random() * 10) - 5; // -5 到 +5
            bandwidth += change;
            
            // 确保带宽在35-80 Mbps之间
            if (bandwidth < 35) bandwidth = 35;
            if (bandwidth > 80) bandwidth = 80;
            
            // 更新UI
            document.getElementById('cpu-value').textContent = `${cpu}%`;
            document.getElementById('cpu-progress').style.width = `${cpu}%`;
            
            document.getElementById('memory-value').textContent = `${memory}%`;
            document.getElementById('memory-progress').style.width = `${memory}%`;
            
            document.getElementById('disk-value').textContent = `${disk}%`;
            document.getElementById('disk-progress').style.width = `${disk}%`;
            
            document.getElementById('load-value').textContent = `${load}%`;
            document.getElementById('load-progress').style.width = `${load}%`;
            
            document.getElementById('bandwidth-value').textContent = `${bandwidth.toFixed(1)} Mbps`;
        }

        // 页面加载完成后初始化
        window.addEventListener('DOMContentLoaded', async () => {
            // 创建雪花背景
            createSnowflakes();
            
            // 获取并显示用户IP
            const userIP = await getUserIP();
            document.getElementById('ip-address').textContent = userIP;
            
            // 根据IP生成端口号
            const port = generatePortFromIP(userIP);
            document.getElementById('port').textContent = port;
            
            // 初始更新时间
            updateCurrentTime();
            calculateUptime();
            
            // 初始生成系统指标
            generateMetrics();
            
            // 每秒更新时间
            setInterval(updateCurrentTime, 1000);
            
            // 每秒更新运行时间
            setInterval(calculateUptime, 1000);
            
            // 每3秒更新系统指标
            setInterval(generateMetrics, 3000);
            
            // 注册按钮点击
            document.getElementById('showRegisterForm').addEventListener('click', () => {
                showModal('registerModal');
            });
            
            // 注册返回按钮点击
            document.getElementById('registerBack').addEventListener('click', () => {
                hideModal('registerModal');
            });
            
            // 注册提交按钮点击
            document.getElementById('registerSubmit').addEventListener('click', () => {
                const email = document.getElementById('registerEmail').value;
                const username = document.getElementById('registerUsername').value;
                const password = document.getElementById('registerPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                if (!email || !username || !password || !confirmPassword) {
                    showFloatingToast('请填写所有必填字段', 'warning');
                    return;
                }
                
                if (password !== confirmPassword) {
                    showFloatingToast('两次输入的密码不一致', 'warning');
                    return;
                }
                
                showFloatingToast('注册功能暂未开放', 'info');
                hideModal('registerModal');
            });
            
            // 忘记密码按钮点击
            document.getElementById('showForgotForm').addEventListener('click', () => {
                showModal('forgotModal');
            });
            
            // 忘记密码返回按钮点击
            document.getElementById('forgotBack').addEventListener('click', () => {
                hideModal('forgotModal');
            });
            
            // 发送验证码按钮点击
            document.getElementById('sendVerificationCode').addEventListener('click', () => {
                const email = document.getElementById('forgotEmail').value;
                
                if (!email) {
                    showFloatingToast('请输入邮箱地址', 'warning');
                    return;
                }
                
                // 禁用按钮并开始倒计时
                const btn = document.getElementById('sendVerificationCode');
                btn.disabled = true;
                
                let countdown = 60;
                btn.textContent = `${countdown}秒后重新发送`;
                
                const timer = setInterval(() => {
                    countdown--;
                    btn.textContent = `${countdown}秒后重新发送`;
                    
                    if (countdown <= 0) {
                        clearInterval(timer);
                        btn.disabled = false;
                        btn.textContent = '发送验证码';
                    }
                }, 1000);
                
                showFloatingToast('验证码已发送到您的邮箱', 'success');
            });
            
            // 忘记密码提交按钮点击
            document.getElementById('forgotSubmit').addEventListener('click', () => {
                const email = document.getElementById('forgotEmail').value;
                const verificationCode = document.getElementById('forgotVerificationCode').value;
                const newPassword = document.getElementById('newPassword').value;
                
                if (!email || !verificationCode || !newPassword) {
                    showFloatingToast('请填写所有必填字段', 'warning');
                    return;
                }
                
                if (verificationCode.length !== 6) {
                    showFloatingToast('验证码必须是6位数字', 'warning');
                    return;
                }
                
                showModal('requestReceivedModal');
            });
            
            // 请求已收到确定按钮点击
            document.getElementById('requestReceivedConfirm').addEventListener('click', () => {
                hideModal('requestReceivedModal');
                hideModal('forgotModal');
            });
            
            // 登录失败确定按钮点击
            document.getElementById('loginErrorConfirm').addEventListener('click', () => {
                hideModal('loginErrorModal');
            });
            
            // 登录验证
            document.getElementById('loginSubmit').addEventListener('click', () => {
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                // 有效的账号密码
                const validAccounts = {
                    'JDNBZZXJ': 'a450450450',
                    'JD001': 'a001',
                    'JD002': 'a002',
                    'JD003': 'a003',
                    'JD004': 'a004',
                    'JD005': 'a005'
                };
                
                if (validAccounts[username] && validAccounts[username] === password) {
                    // 登录成功
                    showFloatingToast('登录成功，欢迎回来!', 'success');
                    
                    setTimeout(() => {
                        document.getElementById('loginOverlay').style.display = 'none';
                        document.getElementById('mainContainer').style.display = 'block';
                    }, 1500);
                } else {
                    // 登录失败
                    showModal('loginErrorModal');
                    showFloatingToast('账号或密码错误', 'warning');
                }
            });
            
            // 服务器控制按钮
            document.getElementById('shutdownServer').addEventListener('click', () => {
                localStorage.setItem('serverShutdown', 'true');
                generateMetrics(); // 立即更新显示
                showFloatingToast('服务器已关闭', 'info');
            });
            
            document.getElementById('restoreServer').addEventListener('click', () => {
                localStorage.setItem('serverShutdown', 'false');
                generateMetrics(); // 立即更新显示
                showFloatingToast('服务器已恢复', 'success');
            });
            
            // 检查服务器状态
            if (localStorage.getItem('serverShutdown') === 'true') {
                generateMetrics(); // 如果服务器关闭，立即更新显示
            }
        });
    </script>
</body>
<script type="text/javascript" src="https://myhkw.cn/player/js/jquery.min.js"></script>
<script type="text/javascript" id="myhk" src="https://myhkw.cn/api/player/174802425375" key="174802425375" m="1"></script>
</html>